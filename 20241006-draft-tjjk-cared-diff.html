<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
<!-- Generated by rfcdiff 1.45: rfcdiff  --> 
<!-- <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional" > -->
<!-- System: Linux at-author-tools-6d78bdc774-2mxcc 6.1.0-25-amd64 #1 SMP PREEMPT_DYNAMIC Debian 6.1.106-3 (2024-08-26) x86_64 x86_64 x86_64 GNU/Linux --> 
<!-- Using awk: /usr/bin/gawk: GNU Awk 5.1.0, API: 3.0 (GNU MPFR 4.1.0, GNU MP 6.2.1) --> 
<!-- Using diff: /usr/bin/diff: diff (GNU diffutils) 3.8 --> 
<!-- Using wdiff: /usr/bin/wdiff: wdiff (GNU wdiff) 1.2.2 --> 
<html xmlns="http://www.w3.org/1999/xhtml"> 
<head> 
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /> 
  <meta http-equiv="Content-Style-Type" content="text/css" /> 
  <title>Diff: 20241006-draft-tjjk-cared-orig.txt - 20241006-draft-tjjk-cared-jabley.txt</title> 
  <style type="text/css"> 
    body    { margin: 0.4ex; margin-right: auto; } 
    tr      { } 
    td      { white-space: pre; font-family: monospace; vertical-align: top; font-size: 0.86em;} 
    th      { font-size: 0.86em; } 
    .small  { font-size: 0.6em; font-style: italic; font-family: Verdana, Helvetica, sans-serif; } 
    .left   { background-color: #EEE; } 
    .right  { background-color: #FFF; } 
    .diff   { background-color: #CCF; } 
    .lblock { background-color: #BFB; } 
    .rblock { background-color: #FF8; } 
    .insert { background-color: #8FF; } 
    .delete { background-color: #ACF; } 
    .void   { background-color: #FFB; } 
    .cont   { background-color: #EEE; } 
    .linebr { background-color: #AAA; } 
    .lineno { color: red; background-color: #FFF; font-size: 0.7em; text-align: right; padding: 0 2px; } 
    .elipsis{ background-color: #AAA; } 
    .left .cont { background-color: #DDD; } 
    .right .cont { background-color: #EEE; } 
    .lblock .cont { background-color: #9D9; } 
    .rblock .cont { background-color: #DD6; } 
    .insert .cont { background-color: #0DD; } 
    .delete .cont { background-color: #8AD; } 
    .stats, .stats td, .stats th { background-color: #EEE; padding: 2px 0; } 
    span.hide { display: none; color: #aaa;}    a:hover span { display: inline; }    tr.change { background-color: gray; } 
    tr.change a { text-decoration: none; color: black } 
  </style> 
     <script>
var chunk_index = 0;
var old_chunk = null;

function format_chunk(index) {
    var prefix = "diff";
    var str = index.toString();
    for (x=0; x<(4-str.length); ++x) {
        prefix+='0';
    }
    return prefix + str;
}

function find_chunk(n){
    return document.querySelector('tr[id$="' + n + '"]');
}

function change_chunk(offset) {
    var index = chunk_index + offset;
    var new_str;
    var new_chunk;

    new_str = format_chunk(index);
    new_chunk = find_chunk(new_str);
    if (!new_chunk) {
        return;
    }
    if (old_chunk) {
        old_chunk.style.outline = "";
    }
    old_chunk = new_chunk;
    old_chunk.style.outline = "1px solid red";
    window.location.hash = "#" + new_str;
    window.scrollBy(0,-100);
    chunk_index = index;
}

document.onkeydown = function(e) {
    switch (e.keyCode) {
    case 78:
        change_chunk(1);
        break;
    case 80:
        change_chunk(-1);
        break;
    }
};
   </script> 
</head> 
<body > 
  <table border="0" cellpadding="0" cellspacing="0"> 
  <tr id="part-1" bgcolor="orange"><th></th><th>&nbsp;20241006-draft-tjjk-cared-orig.txt&nbsp;</th><th> </th><th>&nbsp;20241006-draft-tjjk-cared-jabley.txt&nbsp;</th><th></th></tr> 
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">Network Working Group                                          T. Jensen</td><td> </td><td class="right">Network Working Group                                          T. Jensen</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">Internet-Draft                                              J. Krynitsky</td><td> </td><td class="right">Internet-Draft                                              J. Krynitsky</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">Intended status: Informational                                 Microsoft</td><td> </td><td class="right">Intended status: Informational                                 Microsoft</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">Expires: 9 April 2025                                          J. Damick</td><td> </td><td class="right">Expires: 9 April 2025                                          J. Damick</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">                                                              M. Engskow</td><td> </td><td class="right">                                                              M. Engskow</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">                                                                  Amazon</td><td> </td><td class="right">                                                                  Amazon</td><td class="lineno"></td></tr>
      <tr id="diff0001"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                <span class="insert">J. Abley</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                                              Cloudflare</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">                                                          6 October 2024</td><td> </td><td class="right">                                                          6 October 2024</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">        Client Authentication Recommendations for Encrypted DNS</td><td> </td><td class="right">        Client Authentication Recommendations for Encrypted DNS</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">                          draft-tjjk-cared-00</td><td> </td><td class="right">                          draft-tjjk-cared-00</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">Abstract</td><td> </td><td class="right">Abstract</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0002"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">For privacy reasons,</span> encrypted DNS clients <span class="delete">need to be anonymous to</span></td><td> </td><td class="rblock">   <span class="insert">Some</span> encrypted DNS clients <span class="insert">require anonymity from</span> their encrypted DNS</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   their encrypted DNS servers to prevent third parties from correlating</td><td> </td><td class="rblock">   servers to prevent third parties from correlating client DNS queries</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   client DNS queries with other data for surveillance or data mining</td><td> </td><td class="rblock">   with other data for surveillance or data mining purposes.  However,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   purposes.  However, there are cases where the client and server have</td><td> </td><td class="rblock">   there are cases where the client and server have a pre-existing</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   a pre-existing relationship and each <span class="delete">peer</span> wants to prove its identity</td><td> </td><td class="rblock">   relationship and each wants to prove its identity to the other.  For</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   to the other.  For example, an encrypted DNS server may only wish to</td><td> </td><td class="rblock">   example, an encrypted DNS server may only wish to accept <span class="insert">queries</span> from</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   accept <span class="delete">resolutions</span> from encrypted DNS clients that are managed by the</td><td> </td><td class="rblock">   encrypted DNS clients that are managed by the same <span class="insert">enterprise, and an</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   same <span class="delete">enterprise.</span>  This requires mutual authentication.</td><td> </td><td class="rblock"><span class="insert">   encrypted DNS client may need to confirm the identity of the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   encrypted DNS server it is communicating with.</span>  This requires mutual</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   authentication.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0003"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   This document <span class="delete">defines when using</span> client authentication with encrypted</td><td> </td><td class="rblock">   This document <span class="insert">discusses the circumstances under which</span> client</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">DNS is appropriate,</span> the benefits and limitations of doing so, and <span class="delete">the</span></td><td> </td><td class="rblock">   authentication <span class="insert">is appropriate to use</span> with encrypted <span class="insert">DNS,</span> the benefits</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   recommended</span> authentication <span class="delete">mechanism(s)</span> when communicating with <span class="delete">TLS-</span></td><td> </td><td class="rblock">   and limitations of doing so, and <span class="insert">recommends</span> authentication <span class="insert">mechanisms</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   based</span> encrypted DNS protocols.</td><td> </td><td class="rblock"><span class="insert">   to be used</span> when communicating with <span class="insert">TLS-based</span> encrypted DNS protocols.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">Status of This Memo</td><td> </td><td class="right">Status of This Memo</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   This Internet-Draft is submitted in full conformance with the</td><td> </td><td class="right">   This Internet-Draft is submitted in full conformance with the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   provisions of BCP 78 and BCP 79.</td><td> </td><td class="right">   provisions of BCP 78 and BCP 79.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Internet-Drafts are working documents of the Internet Engineering</td><td> </td><td class="right">   Internet-Drafts are working documents of the Internet Engineering</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Task Force (IETF).  Note that other groups may also distribute</td><td> </td><td class="right">   Task Force (IETF).  Note that other groups may also distribute</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   working documents as Internet-Drafts.  The list of current Internet-</td><td> </td><td class="right">   working documents as Internet-Drafts.  The list of current Internet-</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Drafts is at https://datatracker.ietf.org/drafts/current/.</td><td> </td><td class="right">   Drafts is at https://datatracker.ietf.org/drafts/current/.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="part-2" class="change" ><td></td><th><small>skipping to change at</small><a href="#part-2"><em> page 2, line 39<span class="hide"> &para;</span></em></a></th><th> </th><th><small>skipping to change at</small><a href="#part-2"><em> page 2, line 39<span class="hide"> &para;</span></em></a></th><td></td></tr>
      <tr><td class="lineno"></td><td class="left">       6.1.2.  Resolving names differently per client  . . . . . . .   5</td><td> </td><td class="right">       6.1.2.  Resolving names differently per client  . . . . . . .   5</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">     6.2.  When clients should attempt to authenticate . . . . . . .   6</td><td> </td><td class="right">     6.2.  When clients should attempt to authenticate . . . . . . .   6</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   7.  Recommendations . . . . . . . . . . . . . . . . . . . . . . .   6</td><td> </td><td class="right">   7.  Recommendations . . . . . . . . . . . . . . . . . . . . . . .   6</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">     7.1.  Why these requirements were chosen  . . . . . . . . . . .   7</td><td> </td><td class="right">     7.1.  Why these requirements were chosen  . . . . . . . . . . .   7</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">       7.1.1.  Per-connection scope  . . . . . . . . . . . . . . . .   7</td><td> </td><td class="right">       7.1.1.  Per-connection scope  . . . . . . . . . . . . . . . .   7</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">       7.1.2.  Reusable open standards . . . . . . . . . . . . . . .   8</td><td> </td><td class="right">       7.1.2.  Reusable open standards . . . . . . . . . . . . . . .   8</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">       7.1.3.  Reusable across protocols . . . . . . . . . . . . . .   8</td><td> </td><td class="right">       7.1.3.  Reusable across protocols . . . . . . . . . . . . . .   8</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">       7.1.4.  Does not require human interaction  . . . . . . . . .   8</td><td> </td><td class="right">       7.1.4.  Does not require human interaction  . . . . . . . . .   8</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">     7.2.  Why alternatives are not recommended  . . . . . . . . . .   8</td><td> </td><td class="right">     7.2.  Why alternatives are not recommended  . . . . . . . . . .   8</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">       7.2.1.  Web tokens  . . . . . . . . . . . . . . . . . . . . .   8</td><td> </td><td class="right">       7.2.1.  Web tokens  . . . . . . . . . . . . . . . . . . . . .   8</td><td class="lineno"></td></tr>
      <tr id="diff0004"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">       7.2.2.  HTTP authentication . . . . . . . . . . . . . . . . .   <span class="delete">8</span></td><td> </td><td class="rblock">       7.2.2.  HTTP authentication . . . . . . . . . . . . . . . . .   <span class="insert">9</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">       7.2.3.  FIDO  . . . . . . . . . . . . . . . . . . . . . . . .   9</td><td> </td><td class="right">       7.2.3.  FIDO  . . . . . . . . . . . . . . . . . . . . . . . .   9</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">       7.2.4.  Designing a novel solution  . . . . . . . . . . . . .   9</td><td> </td><td class="right">       7.2.4.  Designing a novel solution  . . . . . . . . . . . . .   9</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   8.  Operational Considerations  . . . . . . . . . . . . . . . . .   9</td><td> </td><td class="right">   8.  Operational Considerations  . . . . . . . . . . . . . . . . .   9</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">     8.1.  Avoiding connectivity deadlocks . . . . . . . . . . . . .   9</td><td> </td><td class="right">     8.1.  Avoiding connectivity deadlocks . . . . . . . . . . . . .   9</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   9.  Security Considerations . . . . . . . . . . . . . . . . . . .  10</td><td> </td><td class="right">   9.  Security Considerations . . . . . . . . . . . . . . . . . . .  10</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   10. IANA Considerations . . . . . . . . . . . . . . . . . . . . .  10</td><td> </td><td class="right">   10. IANA Considerations . . . . . . . . . . . . . . . . . . . . .  10</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   11. References  . . . . . . . . . . . . . . . . . . . . . . . . .  10</td><td> </td><td class="right">   11. References  . . . . . . . . . . . . . . . . . . . . . . . . .  10</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">     11.1.  Normative References . . . . . . . . . . . . . . . . . .  10</td><td> </td><td class="right">     11.1.  Normative References . . . . . . . . . . . . . . . . . .  10</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">     11.2.  Informative References . . . . . . . . . . . . . . . . .  10</td><td> </td><td class="right">     11.2.  Informative References . . . . . . . . . . . . . . . . .  10</td><td class="lineno"></td></tr>
      <tr id="diff0005"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Acknowledgments . . . . . . . . . . . . . . . . . . . . . . . . .  <span class="delete">11</span></td><td> </td><td class="rblock">   Acknowledgments . . . . . . . . . . . . . . . . . . . . . . . . .  <span class="insert">12</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .  <span class="delete">11</span></td><td> </td><td class="rblock">   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .  <span class="insert">12</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">1.  Introduction</td><td> </td><td class="right">1.  Introduction</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0006"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   There are times when a client needs to <span class="delete">identify</span> itself to a DNS</td><td> </td><td class="rblock">   There are times when a client needs to <span class="insert">authenticate</span> itself <span class="insert">before it</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   server.  One example <span class="delete">would be</span> when an encrypted DNS server only</td><td> </td><td class="rblock"><span class="insert">   can be authorised</span> to <span class="insert">use</span> a DNS server.  One example <span class="insert">is</span> when an</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   accepts connections from pre-approved clients, such as an encrypted</td><td> </td><td class="rblock">   encrypted DNS server only accepts connections from pre-approved</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   DNS service provided by an enterprise for its remote <span class="delete">employees to</span></td><td> </td><td class="rblock">   clients, such as an encrypted DNS service provided by an enterprise</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   access when they are not connecting to the Internet through a network</span></td><td> </td><td class="rblock">   for its remote <span class="insert">employees.</span>  Encrypted DNS clients trying to connect to</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   managed by that enterprise.</span>  Encrypted DNS clients trying to connect</td><td> </td><td class="rblock">   such a server <span class="insert">might experience</span> refused connections if they did not</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   to such a server <span class="delete">would likely run into</span> refused connections if they</td><td> </td><td class="rblock">   provide authentication that <span class="insert">allows the</span> enterprise's <span class="insert">server</span> to</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   did not provide authentication that <span class="delete">proves they have that</span></td><td> </td><td class="rblock">   <span class="insert">authorise its use.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   enterprise's <span class="delete">permission</span> to <span class="delete">query this server.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   This is different from general use of encrypted DNS by anonymous</td><td> </td><td class="right">   This is different from general use of encrypted DNS by anonymous</td><td class="lineno"></td></tr>
      <tr id="diff0007"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   clients to public DNS resolvers, where it is bad practice to provide</td><td> </td><td class="rblock">   clients to public DNS resolvers, where it is bad practice <span class="insert">for the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   any kind of identifying information to <span class="delete">an encrypted DNS</span> server.  For</td><td> </td><td class="rblock"><span class="insert">   client</span> to provide any kind of identifying information to <span class="insert">the</span> server.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   example, Section 8.2 of <span class="delete">RFC 8484 {todo: ref}</span> discourages use of HTTP</td><td> </td><td class="rblock">   For example, Section 8.2 of <span class="insert">[RFC8484]</span> discourages use of HTTP cookies</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   cookies with <span class="delete">DoH.</span>  This ensures that clients provide a minimal amount</td><td> </td><td class="rblock">   with <span class="insert">DNS over HTTP (DoH).</span>  This ensures that clients provide a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   of identifiable or correlatable information to servers that do not</td><td> </td><td class="rblock">   minimal amount of identifiable or correlatable information to servers</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   need to know anything about the client in order to provide name</td><td> </td><td class="rblock">   that do not need to know anything about the client in order to</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   resolution.</td><td> </td><td class="rblock">   provide name resolution.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Because of the significant difference in these scenarios, it is</td><td> </td><td class="right">   Because of the significant difference in these scenarios, it is</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   important to define the situations in which interoperable encrypted</td><td> </td><td class="right">   important to define the situations in which interoperable encrypted</td><td class="lineno"></td></tr>
      <tr id="diff0008"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   DNS clients can use client authentication without <span class="delete">regressing</span> the</td><td> </td><td class="rblock">   DNS clients can use client authentication without <span class="insert">compromising</span> the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   privacy <span class="delete">value</span> provided by encrypted DNS in the first place.  Even</td><td> </td><td class="rblock">   privacy provided by encrypted DNS in the first place.  Even then, it</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   then, it is important to recognize what value client authentication</td><td> </td><td class="rblock">   is important to recognize what value client authentication provides</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   provides to encrypted DNS clients versus encrypted DNS servers in the</td><td> </td><td class="rblock">   to encrypted DNS clients versus encrypted DNS servers in the context</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   context of both connection management and DNS resolution utility.</td><td> </td><td class="rblock">   of both connection management and DNS resolution utility.  This</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   This document <span class="delete">will go through</span> these topics <span class="delete">as well as make</span> best</td><td> </td><td class="rblock">   document <span class="insert">discusses</span> these topics <span class="insert">and recommends</span> best practice for</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   practice <span class="delete">recommendations</span> for authentication.</td><td> </td><td class="rblock">   authentication.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">2.  Conventions and Definitions</td><td> </td><td class="right">2.  Conventions and Definitions</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",</td><td> </td><td class="right">   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and</td><td> </td><td class="right">   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   "OPTIONAL" in this document are to be interpreted as described in</td><td> </td><td class="right">   "OPTIONAL" in this document are to be interpreted as described in</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   BCP 14 [RFC2119] [RFC8174] when, and only when, they appear in all</td><td> </td><td class="right">   BCP 14 [RFC2119] [RFC8174] when, and only when, they appear in all</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   capitals, as shown here.</td><td> </td><td class="right">   capitals, as shown here.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">3.  Terminology</td><td> </td><td class="right">3.  Terminology</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="part-3" class="change" ><td></td><th><small>skipping to change at</small><a href="#part-3"><em> page 4, line 11<span class="hide"> &para;</span></em></a></th><th> </th><th><small>skipping to change at</small><a href="#part-3"><em> page 4, line 11<span class="hide"> &para;</span></em></a></th><td></td></tr>
      <tr><td class="lineno"></td><td class="left">   Encrypted DNS server: a recursive DNS resolver that implements one or</td><td> </td><td class="right">   Encrypted DNS server: a recursive DNS resolver that implements one or</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   more encrypted DNS protocols, such as those defined in [RFC9499]</td><td> </td><td class="right">   more encrypted DNS protocols, such as those defined in [RFC9499]</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   (DNS-over-TLS, DNS-over-HTTPS, DNS-over-QUIC).</td><td> </td><td class="right">   (DNS-over-TLS, DNS-over-HTTPS, DNS-over-QUIC).</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Protective DNS server: a policy-implementing, recursive DNS resolver</td><td> </td><td class="right">   Protective DNS server: a policy-implementing, recursive DNS resolver</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   service that filters DNS queries to prevent resolution for known</td><td> </td><td class="right">   service that filters DNS queries to prevent resolution for known</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   malicious domains and/or IP addresses.  Protective DNS servers</td><td> </td><td class="right">   malicious domains and/or IP addresses.  Protective DNS servers</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   support DNS technologies including encrypted DNS protocol support</td><td> </td><td class="right">   support DNS technologies including encrypted DNS protocol support</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   (DoH/DoT) and IPv6 resolution.</td><td> </td><td class="right">   (DoH/DoT) and IPv6 resolution.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0009"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">Other terminology related to the DNS is used in this document as</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   defined in [RFC9499].</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">4.  Benefits of client authentication with encrypted DNS</td><td> </td><td class="right">4.  Benefits of client authentication with encrypted DNS</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Strong identification of encrypted DNS clients by the encrypted DNS</td><td> </td><td class="right">   Strong identification of encrypted DNS clients by the encrypted DNS</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   server allows the DNS server to apply client-specific resolution</td><td> </td><td class="right">   server allows the DNS server to apply client-specific resolution</td><td class="lineno"></td></tr>
      <tr id="diff0010"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   policies in a <span class="delete">securely verifiable</span> way.  Today, a common practice is</td><td> </td><td class="rblock">   policies in a <span class="insert">securely-verifiable</span> way.  Today, a common practice is</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   to establish client-specific resolution policies that <span class="delete">differentiate</span></td><td> </td><td class="rblock">   to establish client-specific resolution policies that <span class="insert">are applied on</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   clients based on their observed IP address.  This is not only an</td><td> </td><td class="rblock"><span class="insert">   behalf of particular</span> clients based on their observed IP address.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   insecure method that cannot account for clients <span class="delete">routing</span> requests</td><td> </td><td class="rblock">   This is not only an insecure method that cannot account for clients</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   through <span class="delete">proxies,</span> but it can only be used when expected IP addresses</td><td> </td><td class="rblock">   <span class="insert">sending</span> requests through <span class="insert">middleboxes,</span> but it can only be used when</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   are known in advance.  This is not practical for enterprises with</td><td> </td><td class="rblock">   expected IP addresses are known in advance.  This is not practical</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   remote employees without introducing a dependency on tunneling DNS</td><td> </td><td class="rblock">   for enterprises with remote employees without introducing a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   traffic to a managed gateway or proxy whose IP address is known.</td><td> </td><td class="rblock">   dependency on tunneling DNS traffic to a managed gateway or proxy</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   This in turn forces enterprises to choose between running proxy or</td><td> </td><td class="rblock">   whose IP address is known.  This in turn forces enterprises to choose</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   gateway infrastructure per client (or at least per-client IP address</td><td> </td><td class="rblock">   between running proxy or gateway infrastructure per client (or at</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   mappings) or losing client identification.</td><td> </td><td class="rblock">   least per-client IP address mappings) or losing client</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   identification.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Strong identification of encrypted DNS clients by the encrypted DNS</td><td> </td><td class="right">   Strong identification of encrypted DNS clients by the encrypted DNS</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   server also brings identification up to the application layer, which</td><td> </td><td class="right">   server also brings identification up to the application layer, which</td><td class="lineno"></td></tr>
      <tr id="diff0011"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">encapsulates this</span> identity management <span class="delete">away</span> from network topology</td><td> </td><td class="rblock">   <span class="insert">insulates the mechanism used for</span> identity management from network</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   changes <span class="delete">(whenever IP address ranges need to change, name resolutions</span></td><td> </td><td class="rblock">   topology changes <span class="insert">and allows the sense</span> of client <span class="insert">identity in the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   have to as well without some form</span> of client <span class="delete">authentication).</span></td><td> </td><td class="rblock"><span class="insert">   server to persist despite client IP address changes.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">5.  Drawbacks of client authentication with encrypted DNS</td><td> </td><td class="right">5.  Drawbacks of client authentication with encrypted DNS</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0012"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   While there are benefits in <span class="delete">limited circumstances for</span> using client</td><td> </td><td class="rblock">   While there are benefits in using client authentication with</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   authentication with encrypted <span class="delete">DNS, it</span> has drawbacks that make it</td><td> </td><td class="rblock">   encrypted <span class="insert">DNS in limited circumstances, authentication</span> has drawbacks</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   inappropriate in <span class="delete">the general case.  The biggest reason</span> client</td><td> </td><td class="rblock">   that make it inappropriate in <span class="insert">many other cases.  For example,</span> client</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   authentication is generally <span class="delete">deemed a</span> bad practice <span class="delete">with</span> encrypted DNS</td><td> </td><td class="rblock">   authentication is generally <span class="insert">considered to be</span> bad practice <span class="insert">in uses of</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">is the obvious identification of clients and the association of their</span></td><td> </td><td class="rblock">   encrypted DNS <span class="insert">that are motivated by client anonyminity, since it</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   queries across connections.  If</span> a <span class="delete">public DNS server, which responds</span></td><td> </td><td class="rblock"><span class="insert">   allows</span> a <span class="insert">full history of resolution requests</span> to be <span class="insert">associated</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   to anonymous clients over the Internet, were</span> to <span class="delete">challenge clients for</span></td><td> </td><td class="rblock"><span class="insert">   confidently with</span> the <span class="insert">identity of an individual client.</span>  This is</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   authentication it would</span> be <span class="delete">forced de-anonymization of</span> the <span class="delete">client's</span></td><td> </td><td class="rblock">   unacceptable practice.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   domain name history.</span>  This is unacceptable practice.</td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0013"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">A less egregious drawback to client authentication with encrypted</span> DNS</td><td> </td><td class="rblock">   <span class="insert">Public</span> DNS <span class="insert">servers generally implement allow-</span> and <span class="insert">blocklists at</span> the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">is the required management of client identities</span> and the <span class="delete">complexity</span> of</td><td> </td><td class="rblock">   <span class="insert">IP layer as part</span> of <span class="insert">a layered defence</span> against <span class="insert">abuse; IP-layer access</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">matrixing domain name allow- and block-lists</span> against <span class="delete">client</span></td><td> </td><td class="rblock"><span class="insert">   control allows unwanted traffic to</span> be <span class="insert">discarded early and helps</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   identities for policy enforcement.  This will</span> be <span class="delete">significantly more</span></td><td> </td><td class="rblock"><span class="insert">   mitigate unwanted server load.  Public</span> encrypted DNS <span class="insert">servers with the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   challenging for</span> encrypted DNS <span class="delete">server operators</span> to <span class="delete">deploy</span> and <span class="delete">require</span></td><td> </td><td class="rblock"><span class="insert">   additional requirement to permit authenticated clients makes it</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   industry-wide adoption.  This drawback will reduce over time as</span></td><td> </td><td class="rblock"><span class="insert">   impossible</span> to <span class="insert">drop unwanted traffic early based on source IP address,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   support for client authentication in encrypted DNS stacks is added.</span></td><td> </td><td class="rblock"><span class="insert">   which increases the cost of mitigation</span> and <span class="insert">adds complexity that may</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   well introduce additional attack vectors.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">6.  When to use client authentication with encrypted DNS</td><td> </td><td class="right">6.  When to use client authentication with encrypted DNS</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0014"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">Client authentication with encrypted</span> DNS SHOULD NOT <span class="delete">be used outside</span></td><td> </td><td class="rblock">   <span class="insert">Encrypted</span> DNS <span class="insert">servers that provide resolution using transport</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   the situations described in this <span class="delete">section to avoid regressing the</span></td><td> </td><td class="rblock"><span class="insert">   protocols that incorporate TLS or dTLS such as DoH [RFC8484], DoT</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   privacy model of encrypted DNS.  It also needs to be acceptable to</span></td><td> </td><td class="rblock"><span class="insert">   [RFC7858], and DoQ [RFC9250]</span> SHOULD NOT <span class="insert">provide client authentication</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   both peers.</span></td><td> </td><td class="rblock"><span class="insert">   except in</span> the <span class="insert">limited</span> situations described in this <span class="insert">section.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0015"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">Only encrypted</span> DNS <span class="delete">protocols</span> that use <span class="delete">TLS or dTLS (such as DoH</span></td><td> </td><td class="rblock">   <span class="insert">Encrypted</span> DNS <span class="insert">servers</span> that use <span class="insert">other transport protocols</span> are <span class="insert">not</span> in</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   [RFC8484], DoT [RFC7858], and DoQ [RFC9250])</span> are in scope for this</td><td> </td><td class="rblock">   scope for this document.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   document.</td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">6.1.  When servers should require client authentication</td><td> </td><td class="right">6.1.  When servers should require client authentication</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Encrypted DNS servers MUST NOT challenge clients for authentication</td><td> </td><td class="right">   Encrypted DNS servers MUST NOT challenge clients for authentication</td><td class="lineno"></td></tr>
      <tr id="diff0016"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">if</span> they <span class="delete">do not</span> need to restrict connections to a set of clients they</td><td> </td><td class="rblock">   <span class="insert">unless</span> they need to restrict connections to a set of clients they</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   have a pre-existing relationship with as defined in <span class="delete">Section 6.1.1,</span></td><td> </td><td class="rblock">   have a pre-existing relationship with as defined in <span class="insert">{restrict-</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   regardless of whether or not the requirements in <span class="delete">Section 6.1.2</span> apply.</td><td> </td><td class="rblock"><span class="insert">   clients},</span> regardless of whether or not the requirements in <span class="insert">{per-</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Encrypted DNS servers that meet the requirements in <span class="delete">Section 6.1.1</span> MAY</td><td> </td><td class="rblock"><span class="insert">   client}</span> apply.  Encrypted DNS servers that meet the requirements in</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   challenge clients to authenticate to avoid achieving the same goal of</td><td> </td><td class="rblock">   <span class="insert">{restrict-clients}</span> MAY challenge clients to authenticate to avoid</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   identifying clients through other, less secure means (such as IP</td><td> </td><td class="rblock">   achieving the same goal of identifying clients through other, less</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   address or data in the DNS query payload).</td><td> </td><td class="rblock">   secure means (such as IP address or data in the DNS query payload).</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">6.1.1.  Restricting connections to allowed clients</td><td> </td><td class="right">6.1.1.  Restricting connections to allowed clients</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0017"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">Some</span> encrypted DNS <span class="delete">servers provide DNS services</span> to a specific set of</td><td> </td><td class="rblock">   <span class="insert">An</span> encrypted DNS <span class="insert">server that provides resolution</span> to a specific set of</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   clients and <span class="delete">refuse</span> service to all other <span class="delete">clients.  One example of this</span></td><td> </td><td class="rblock">   clients and <span class="insert">refuses</span> service to all other <span class="insert">clients MAY require clients</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   may be an encrypted DNS server owned by an enterprise that only</span></td><td> </td><td class="rblock"><span class="insert">   to authenticate.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   allows connections from devices managed by that same enterprise.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0018"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">Encrypted</span> DNS <span class="delete">servers SHOULD NOT challenge clients to authenticate</span></td><td> </td><td class="rblock">   <span class="insert">For example, an encrypted</span> DNS server <span class="insert">owned by an enterprise that only</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   when the</span> server <span class="delete">knows it does not have a securely verifiable identity</span></td><td> </td><td class="rblock"><span class="insert">   allows connections from devices managed by that same enterprise might</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   (such as when it is expecting clients to connect opportunistically as</span></td><td> </td><td class="rblock"><span class="insert">   require</span> clients to <span class="insert">authenticate.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   defined in Section 4.1 of [RFC7858]).  Such servers do not need to</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   identify allowed clients, since security-minded</span> clients <span class="delete">need to know</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   to <span class="delete">whom they are authenticating.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">6.1.2.  Resolving names differently per client</td><td> </td><td class="right">6.1.2.  Resolving names differently per client</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0019"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">Some</span> encrypted DNS <span class="delete">servers need to change their resolution behavior</span></td><td> </td><td class="rblock">   <span class="insert">An</span> encrypted DNS <span class="insert">server</span> that <span class="insert">provides client-specific resolution</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   based on the identity of the client</span> that <span class="delete">issued the query because</span></td><td> </td><td class="rblock"><span class="insert">   behaviour MAY require</span> clients to <span class="insert">authenticate in circumstances where</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   some</span> clients <span class="delete">have permission</span> to <span class="delete">resolve names that other</span> clients <span class="delete">do</span></td><td> </td><td class="rblock"><span class="insert">   the appropriate policy for particular</span> clients <span class="insert">is specified by the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   not.</span></td><td> </td><td class="rblock"><span class="insert">   operator of the encrypted DNS server.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0020"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Encrypted DNS servers SHOULD NOT attempt to authenticate clients when</td><td> </td><td class="rblock">   <span class="insert">For example, an encrypted DNS server that is configured to allow some</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   the difference in resolution behavior between them is <span class="delete">opted into</span> by</td><td> </td><td class="rblock"><span class="insert">   clients to resolve certain names while other clients are not allowed</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   the <span class="delete">client rather than required by</span> the <span class="delete">authority operating</span> the</td><td> </td><td class="rblock"><span class="insert">   needs to identify the client so that the resolution behaviour for</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">encrypted DNS server.</span>  For example, some public DNS services <span class="delete">offer</span></td><td> </td><td class="rblock"><span class="insert">   those names can be implemented accurately.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   multiple servers that each have different</span> resolution <span class="delete">behavior.  One</span></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   might resolve almost every name, whereas another may try to refuse to</span></td><td> </td><td class="rblock">   Encrypted DNS servers SHOULD NOT attempt to authenticate clients <span class="insert">to</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   resolve</span> names associated with <span class="delete">social media sites,</span> or advertisers, <span class="delete">or</span></td><td> </td><td class="rblock"><span class="insert">   identify the appropriate resolution policy to use</span> when the difference</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   other categories customers find useful.  This can be met by defining</span></td><td> </td><td class="rblock">   in resolution behavior between them is <span class="insert">not imposed</span> by the <span class="insert">operator of</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   these endpoints as separate</span> servers on different <span class="delete">dedicated</span> IP</td><td> </td><td class="rblock">   the <span class="insert">server but instead is chosen by</span> the <span class="insert">client.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">addresses or using different domain names in their encryped DNS</span></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   configuration (such as DoH template), or both.</span></td><td> </td><td class="rblock">   For example, some public <span class="insert">encrypted</span> DNS services <span class="insert">provide clients with</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   the option of blocking</span> resolution <span class="insert">requests for particular categories</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   of domain names, such as</span> names associated with <span class="insert">malware distribution,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   adult content</span> or advertisers, <span class="insert">and makes</span> servers <span class="insert">with particular</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   resolution policies available</span> on different IP <span class="insert">addresses.  A client</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   who wishes to opt-in to a server with a particular resolution policy</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   can do so by sending queries to the corresponding IP address, and no</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   client identification is required.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">6.2.  When clients should attempt to authenticate</td><td> </td><td class="right">6.2.  When clients should attempt to authenticate</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0021"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">Encrypted</span> DNS <span class="delete">clients</span> MUST NOT offer authentication to any encrypted</td><td> </td><td class="rblock">   <span class="insert">An encrypted</span> DNS <span class="insert">client</span> MUST NOT offer authentication to any</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   DNS server unless it was specifically configured to expect that</td><td> </td><td class="rblock">   encrypted DNS server unless it was specifically configured to expect</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   server to require authentication, independent of the mechanism by</td><td> </td><td class="rblock">   that server to require authentication, independent of the mechanism</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   which the client <span class="delete">was configured with</span> or discovered the encrypted DNS</td><td> </td><td class="rblock">   by which the client <span class="insert">chose</span> or discovered the encrypted DNS <span class="insert">server to</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">server.</span></td><td> </td><td class="rblock"><span class="insert">   use.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0022"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">Encrypted</span> DNS <span class="delete">clients</span> MUST NOT offer authentication when the server</td><td> </td><td class="rblock">   <span class="insert">An encrypted</span> DNS <span class="insert">client</span> MUST NOT offer authentication when the server</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   connection was established <span class="delete">via</span> DDR [RFC9462], even if the IP address</td><td> </td><td class="rblock">   connection was established <span class="insert">using</span> DDR [RFC9462], even if the IP</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   of the original DNS server was specifically configured for the</td><td> </td><td class="rblock">   address of the original DNS server was specifically configured for</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   encrypted DNS client as one that might require authentication.  This</td><td> </td><td class="rblock">   the encrypted DNS client as one that might require authentication.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   is because in that circumstance there is not a pre-existing</td><td> </td><td class="rblock">   This is because in that circumstance there is not a pre-existing</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   relationship with the encrypted DNS server (or else DDR bootstrapping</td><td> </td><td class="right">   relationship with the encrypted DNS server (or else DDR bootstrapping</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   into encrypted DNS would not have been necessary).</td><td> </td><td class="right">   into encrypted DNS would not have been necessary).</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   TBD: what to do with EDSR destinations [EDSR-REDIRECTION]</td><td> </td><td class="right">   TBD: what to do with EDSR destinations [EDSR-REDIRECTION]</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0023"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">Otherwise, an</span> encrypted DNS client MAY choose to present</td><td> </td><td class="rblock">   <span class="insert">An</span> encrypted DNS client MAY choose to present authentication to a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   authentication to a server that requests it, but is not required to</td><td> </td><td class="rblock">   server that requests it, but is not required to do <span class="insert">so; for example, a</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">just because it was challenged to</span> do <span class="delete">so if the</span> client <span class="delete">would rather</span></td><td> </td><td class="rblock">   client <span class="insert">MAY choose instead</span> not <span class="insert">to</span> use the <span class="insert">server.  If a</span> client <span class="insert">does</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   not use the <span class="delete">server altogether.  The presented</span> client identity SHOULD</td><td> </td><td class="rblock"><span class="insert">   present an identity to a server, the</span> identity SHOULD be unique to</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   be unique <span class="delete">per server identity</span> to <span class="delete">avoid becoming</span> a <span class="delete">correlatable</span></td><td> </td><td class="rblock">   <span class="insert">that server, to reduce the risk of</span> a <span class="insert">client's resolution history on</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   identity between</span> colluding <span class="delete">encrypted DNS servers.</span></td><td> </td><td class="rblock"><span class="insert">   multiple</span> colluding <span class="insert">servers being correlated.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">7.  Recommendations</td><td> </td><td class="right">7.  Recommendations</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The following requirements were considered when formulating the</td><td> </td><td class="right">   The following requirements were considered when formulating the</td><td class="lineno"></td></tr>
      <tr id="diff0024"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   recommended authentication mechanism for encrypted DNS <span class="delete">clients:</span></td><td> </td><td class="rblock">   recommended authentication mechanism for encrypted DNS <span class="insert">clients.  The</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   authentication mechanism:</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0025"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">*</span>  SHOULD be per-connection, not <span class="delete">per-query (avoid</span> unnecessary payload</td><td> </td><td class="rblock">   <span class="insert">1.</span>  SHOULD be per-connection, not <span class="insert">per-query, e.g. to avoid</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      <span class="delete">overheads)</span></td><td> </td><td class="rblock">       unnecessary payload <span class="insert">overheads</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0026"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">*</span>  SHOULD use <span class="delete">existing open standards (avoid</span> vendor lock-in and</td><td> </td><td class="rblock">   <span class="insert">2.</span>  SHOULD use <span class="insert">open, standard mechanisms where possible, e.g. to</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      specialized <span class="delete">cryptography)</span></td><td> </td><td class="rblock"><span class="insert">       avoid</span> vendor lock-in and specialized <span class="insert">cryptography</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0027"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">*</span>  SHOULD be reusable across multiple encrypted DNS <span class="delete">protocols (avoid</span></td><td> </td><td class="rblock">   <span class="insert">3.</span>  SHOULD be reusable across multiple encrypted DNS <span class="insert">protocols, e.g.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      protocol <span class="delete">preference)</span></td><td> </td><td class="rblock"><span class="insert">       to avoid</span> protocol <span class="insert">preference</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0028"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">*</span>  SHOULD NOT require human user interaction to complete</td><td> </td><td class="rblock">   <span class="insert">4.</span>  SHOULD NOT require human user interaction to complete</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      authentication</td><td> </td><td class="rblock">       authentication</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0029"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   This document concludes that the <span class="delete">current</span> best mechanism for encrypted</td><td> </td><td class="rblock">   This document concludes that the best mechanism for encrypted DNS</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   DNS client authentication is mTLS [RFC8705] for the following</td><td> </td><td class="rblock">   client authentication is mTLS [RFC8705] for the following reasons:</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   reasons:</td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0030"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">*</span>  mTLS identifies and authenticates clients, not users, per-</td><td> </td><td class="rblock">   <span class="insert">1.</span>  mTLS identifies and authenticates clients, not users, per-</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      connection</td><td> </td><td class="rblock">       connection</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0031"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">*</span>  mTLS is an <span class="delete">exiting</span> standard and is often <span class="delete">already configured</span> for</td><td> </td><td class="rblock">   <span class="insert">2.</span>  mTLS is an <span class="insert">existing</span> standard and is often <span class="insert">readily available</span> for</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      TLS clients</td><td> </td><td class="rblock">       TLS clients</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0032"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">*  x.509</span> certificates used for TLS client authentication allow <span class="delete">the</span></td><td> </td><td class="rblock">   <span class="insert">3.  X.509</span> certificates used for TLS client authentication allow <span class="insert">a</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      server to <span class="delete">identify</span> the client's organization via PKI heiracrchy</td><td> </td><td class="rblock">       server to <span class="insert">include other attributes in an authentication decision,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       such as</span> the client's organization via PKI heiracrchy</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0033"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">*</span>  mTLS is reusable across multiple encrypted DNS protocols</td><td> </td><td class="rblock">   <span class="insert">4.</span>  mTLS is reusable across multiple encrypted DNS protocols</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0034"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">*</span>  mTLS allows session resumption [RFC8446]</td><td> </td><td class="rblock">   <span class="insert">5.</span>  mTLS allows session resumption [RFC8446]</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0035"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">*</span>  mTLS does not require user interaction or apaplication layer input</td><td> </td><td class="rblock">   <span class="insert">6.</span>  mTLS does not require user interaction or apaplication layer</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      for authentication</td><td> </td><td class="rblock">       input for authentication</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Encrypted DNS clients and servers that support offering or requesting</td><td> </td><td class="right">   Encrypted DNS clients and servers that support offering or requesting</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   client authentication MUST support at least the use of mTLS in</td><td> </td><td class="right">   client authentication MUST support at least the use of mTLS in</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   addition to whatever other mechanism they wish to support.</td><td> </td><td class="right">   addition to whatever other mechanism they wish to support.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Encrypted DNS clients and servers SHOULD prefer long-lived</td><td> </td><td class="right">   Encrypted DNS clients and servers SHOULD prefer long-lived</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   connections when using client authentication to minimize the cost</td><td> </td><td class="right">   connections when using client authentication to minimize the cost</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   over time of doing repeated TLS handshakes and identity verification.</td><td> </td><td class="right">   over time of doing repeated TLS handshakes and identity verification.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">7.1.  Why these requirements were chosen</td><td> </td><td class="right">7.1.  Why these requirements were chosen</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="part-4" class="change" ><td></td><th><small>skipping to change at</small><a href="#part-4"><em> page 8, line 46<span class="hide"> &para;</span></em></a></th><th> </th><th><small>skipping to change at</small><a href="#part-4"><em> page 9, line 13<span class="hide"> &para;</span></em></a></th><td></td></tr>
      <tr><td class="lineno"></td><td class="left">   authorization server, as described in [RFC8705].</td><td> </td><td class="right">   authorization server, as described in [RFC8705].</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">7.2.2.  HTTP authentication</td><td> </td><td class="right">7.2.2.  HTTP authentication</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   HTTP authentication as defined in [RFC9110] provides a basic</td><td> </td><td class="right">   HTTP authentication as defined in [RFC9110] provides a basic</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   authentication scheme for the HTTP protocol.  Unless it is used with</td><td> </td><td class="right">   authentication scheme for the HTTP protocol.  Unless it is used with</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   TLS, i.e. over HTTPS, the credentials are encoded but not encrypted</td><td> </td><td class="right">   TLS, i.e. over HTTPS, the credentials are encoded but not encrypted</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   which is insecure.  As TLS is already used by the encrypted DNS</td><td> </td><td class="right">   which is insecure.  As TLS is already used by the encrypted DNS</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   protocols in this document's scope, it is simpler to handle client</td><td> </td><td class="right">   protocols in this document's scope, it is simpler to handle client</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   authentication and authorization at the TLS layer.  Additionally,</td><td> </td><td class="right">   authentication and authorization at the TLS layer.  Additionally,</td><td class="lineno"></td></tr>
      <tr id="diff0036"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   mTLS is more broadly<span class="delete"> </span>adopted than HTTP authentication.  HTTP</td><td> </td><td class="rblock">   mTLS is more broadly<span class="insert">-</span>adopted than HTTP authentication.  HTTP</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   authentication would only be a viable option for DoH, and not</td><td> </td><td class="right">   authentication would only be a viable option for DoH, and not</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   extensible to other encrypted DNS solutions.</td><td> </td><td class="right">   extensible to other encrypted DNS solutions.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">7.2.3.  FIDO</td><td> </td><td class="right">7.2.3.  FIDO</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Web Authentication (WebAuthN) and the FIDO2 Client to Authenticator</td><td> </td><td class="right">   Web Authentication (WebAuthN) and the FIDO2 Client to Authenticator</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Protocol (CTAP) use CBOR Object Signing and Encryption (COSE),</td><td> </td><td class="right">   Protocol (CTAP) use CBOR Object Signing and Encryption (COSE),</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   described in [RFC8812].  FIDO and WebAuthN are passkey solutions</td><td> </td><td class="right">   described in [RFC8812].  FIDO and WebAuthN are passkey solutions</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   designed to replace passwords for user authentication for online</td><td> </td><td class="right">   designed to replace passwords for user authentication for online</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   services, and they are not typically used for general client</td><td> </td><td class="right">   services, and they are not typically used for general client</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="part-5" class="change" ><td></td><th><small>skipping to change at</small><a href="#part-5"><em> page 9, line 47<span class="hide"> &para;</span></em></a></th><th> </th><th><small>skipping to change at</small><a href="#part-5"><em> page 10, line 15<span class="hide"> &para;</span></em></a></th><td></td></tr>
      <tr><td class="lineno"></td><td class="left">   Encrypted DNS servers that challenge clients for authentication</td><td> </td><td class="right">   Encrypted DNS servers that challenge clients for authentication</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   SHOULD have a separate resolution policy for clients that do not have</td><td> </td><td class="right">   SHOULD have a separate resolution policy for clients that do not have</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   valid credentials that allows them to resolve the subset of names</td><td> </td><td class="right">   valid credentials that allows them to resolve the subset of names</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   needed to connect to the infrastructure needed to acquire</td><td> </td><td class="right">   needed to connect to the infrastructure needed to acquire</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   certificates.</td><td> </td><td class="right">   certificates.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Alternatively, encrypted DNS clients that are configured to use</td><td> </td><td class="right">   Alternatively, encrypted DNS clients that are configured to use</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   encrypted DNS servers that will require authentication MAY consider</td><td> </td><td class="right">   encrypted DNS servers that will require authentication MAY consider</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   configuring knowledge of certificate issuing infrastructure in</td><td> </td><td class="right">   configuring knowledge of certificate issuing infrastructure in</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   advance so that the DNS deadlock can be avoided without introducing</td><td> </td><td class="right">   advance so that the DNS deadlock can be avoided without introducing</td><td class="lineno"></td></tr>
      <tr id="diff0037"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   less secure DNS servers to their configuration (i.e. hard coding IP</td><td> </td><td class="rblock">   less secure DNS servers to their configuration (i.e. <span class="insert"> </span>hard coding IP</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   addresses and host names for certificate checking).</td><td> </td><td class="right">   addresses and host names for certificate checking).</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">9.  Security Considerations</td><td> </td><td class="right">9.  Security Considerations</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   This document describes when and how encrypted DNS clients can</td><td> </td><td class="right">   This document describes when and how encrypted DNS clients can</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   authenticate themselves to an encrypted DNS server.  It does not</td><td> </td><td class="right">   authenticate themselves to an encrypted DNS server.  It does not</td><td class="lineno"></td></tr>
      <tr id="diff0038"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   introduce any new security considerations <span class="delete">not already covered by</span> TLS</td><td> </td><td class="rblock">   introduce any new security considerations <span class="insert">beyond those of</span> TLS and</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   and mTLS.  This document does not define recommendations for when and</td><td> </td><td class="rblock">   mTLS.  This document does not define recommendations for when and how</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   how to use encrypted DNS client authentication for encrypted DNS</td><td> </td><td class="rblock">   to use encrypted DNS client authentication for encrypted DNS</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   protocols that are <span class="delete">not TLS-based.</span></td><td> </td><td class="rblock">   protocols that are <span class="insert">based on TLS or dTLS.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">10.  IANA Considerations</td><td> </td><td class="right">10.  IANA Considerations</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   This document has no IANA actions.</td><td> </td><td class="right">   This document has no IANA actions.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">11.  References</td><td> </td><td class="right">11.  References</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">11.1.  Normative References</td><td> </td><td class="right">11.1.  Normative References</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate</td><td> </td><td class="right">   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="part-6" class="change" ><td></td><th><small>skipping to change at</small><a href="#part-6"><em> page 12, line 4<span class="hide"> &para;</span></em></a></th><th> </th><th><small>skipping to change at</small><a href="#part-6"><em> page 12, line 18<span class="hide"> &para;</span></em></a></th><td></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">Authors' Addresses</td><td> </td><td class="right">Authors' Addresses</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Tommy Jensen</td><td> </td><td class="right">   Tommy Jensen</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Microsoft</td><td> </td><td class="right">   Microsoft</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Email: tojens@microsoft.com</td><td> </td><td class="right">   Email: tojens@microsoft.com</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Jessica Krynitsky</td><td> </td><td class="right">   Jessica Krynitsky</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Microsoft</td><td> </td><td class="right">   Microsoft</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Email: jess.krynitsky@microsoft.com</td><td> </td><td class="right">   Email: jess.krynitsky@microsoft.com</td><td class="lineno"></td></tr>
      <tr id="diff0039"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                                                         </span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Jeffrey Damick</td><td> </td><td class="right">   Jeffrey Damick</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Amazon</td><td> </td><td class="right">   Amazon</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Email: jdamick@amazon.com</td><td> </td><td class="right">   Email: jdamick@amazon.com</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Matt Engskow</td><td> </td><td class="right">   Matt Engskow</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Amazon</td><td> </td><td class="right">   Amazon</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Email: mengskow@amazon.com</td><td> </td><td class="right">   Email: mengskow@amazon.com</td><td class="lineno"></td></tr>
      <tr id="diff0040"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">Joe Abley</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Cloudflare</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Email: jabley@cloudflare.com</span></td><td class="lineno"></td></tr>

     <tr><td></td><td class="left"></td><td> </td><td class="right"></td><td></td></tr>
     <tr id="end" bgcolor="gray"><th colspan="5" align="center">&nbsp;End of changes. 40 change blocks.&nbsp;</th></tr>
     <tr class="stats"><td></td><th><i>151 lines changed or deleted</i></th><th><i> </i></th><th><i>162 lines changed or added</i></th><td></td></tr>
     <tr><td colspan="5" align="center" class="small"><br/>This html diff was produced by rfcdiff 1.45. The latest version is available from <a href="http://www.tools.ietf.org/tools/rfcdiff/" >http://tools.ietf.org/tools/rfcdiff/</a> </td></tr>
   </table>
   <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'8ce4af672f1f66db',t:'MTcyODIwNzU3Ni4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
   </html>
